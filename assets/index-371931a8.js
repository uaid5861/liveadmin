import{u as L,h as U}from"./useAuth-2ec42edf.js";import{u as A}from"./useAuthButtons-9e7fcd42.js";import{g as F,u as R}from"./creator-196af5e0.js";import{d as V,V as $,r as c,a as t,o as f,f as h,g as r,e as l,b as m,c as T,p as P,Q as b,F as E,A as Y,l as q,j as C,a8 as H,i as D}from"./index-e1b9afb8.js";import{C as N,S as I}from"./constant-caca95d8.js";import{u as M}from"./useHandleData-9b50ca4a.js";const j=V({name:"RoleDialog"}),z=V({...j,setup(B,{expose:g}){const _=$({levle:[{required:!0,message:"请选择用户等级"}]}),u=c(!1),s=c(!1),o=c({}),w=e=>{o.value=e,s.value=!0},v=c(),y=()=>{v.value.validate(async e=>{if(e)try{u.value=!0,await o.value.api(o.value.rowData),Y.success({message:`修改${o.value.rowData.name}用户等级成功！`}),o.value.getTableList(),s.value=!1,u.value=!1}catch(a){u.value=!1,console.log(a)}})};return g({acceptParams:w}),(e,a)=>{const i=t("el-option"),p=t("el-select"),d=t("el-form-item"),k=t("el-form"),x=t("el-button"),S=t("el-dialog");return f(),h(S,{modelValue:s.value,"onUpdate:modelValue":a[2]||(a[2]=n=>s.value=n),"destroy-on-close":!0,title:"编辑",width:"30%"},{footer:r(()=>[l(x,{onClick:a[1]||(a[1]=n=>s.value=!1)},{default:r(()=>[m("取消")]),_:1}),l(x,{type:"primary",onClick:y,loading:u.value},{default:r(()=>[m(" 确定 ")]),_:1},8,["loading"])]),default:r(()=>[l(k,{ref_key:"ruleFormRef",ref:v,"label-width":"120px","label-suffix":" :",rules:_,model:{...o.value.rowData}},{default:r(()=>[l(d,{label:"创作等级",prop:"level"},{default:r(()=>[l(p,{modelValue:o.value.rowData.level,"onUpdate:modelValue":a[0]||(a[0]=n=>o.value.rowData.level=n),placeholder:"请选择创作等级",style:{width:"90%"}},{default:r(()=>[(f(!0),T(E,null,P(b(N),n=>(f(),h(i,{key:n.value,label:n.label,value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])}}}),W=V({__name:"index",setup(B){const g=q(),{BUTTONS:_}=A(),u=[{prop:"id",label:"ID",width:80,fixed:"left"},{prop:"name",label:"用户名",fixed:"left",search:{el:"input",props:{placeholder:"请输入用户名"}}},{prop:"avatar",label:"头像",width:100,render:({row:e})=>l(E,null,[l(t("el-avatar"),{size:50,src:e.avatar},null)])},{prop:"phone",label:"手机号",width:140,search:{el:"input",props:{placeholder:"请输入手机号"}}},{prop:"sex",label:"性别",width:100,render:({row:e})=>e.sex===0?"男":"女",fieldNames:{label:"name",value:"id"},enum:C(()=>I||[]),search:{el:"select",props:{placeholder:"请选择性别"}}},{prop:"level",label:"创作等级",width:100,enum:C(()=>N||[]),search:{el:"select",props:{placeholder:"请选择VIP等级"}},render:({row:e})=>l("span",null,[e.level])},{prop:"longVideoNum",label:"长视频数量",width:100},{prop:"shortVideoNum",label:"断视频数量",width:100},{prop:"onlineStatus",label:"在线状态",width:100,render:({row:e})=>e.onlineStatus===0?l(t("el-tag"),{type:"success"},{default:()=>[m("在线")]}):l(t("el-tag"),{type:"info"},{default:()=>[m("离线")]})},{prop:"createTime",label:"注册时间",width:180,search:{el:"date-picker",span:2,props:{type:"datetimerange",valueFormat:"YYYY-MM-DD HH:mm:ss"}}},{prop:"status",label:"状态",width:110,render:({row:e})=>l(t("el-switch"),{modelValue:e.status,"onUpdate:modelValue":a=>e.status=a,"active-text":e.status?"启用":"禁用",onClick:()=>v(e)},null)},{prop:"operation",label:"操作",fixed:"right",width:180}],s=c(),o=c(),w=async(e,a)=>{var p;await L(U("btn.UserNormal.update"));let i={rowData:{...a},api:R,getTableList:(p=s.value)==null?void 0:p.getTableList};o.value.acceptParams(i)},v=async e=>{await M(H,{type:"normalUser",id:e.id,status:e.status==1?0:1},`切换【${e.name}】用户状态`)},y=e=>{g.push({path:`/user/creator/show/${e}`})};return(e,a)=>{const i=t("el-button"),p=t("ProTable");return f(),T("div",null,[l(p,{ref_key:"proTable",ref:s,columns:u,requestApi:b(F)},{operation:r(d=>[d.row.status!==1?(f(),h(i,{key:0,type:"primary",link:"",icon:"Edit",disabled:!b(_)["btn.UserNormal.update"],onClick:k=>w("编辑",d.row)},{default:r(()=>[m(" 编辑 ")]),_:2},1032,["disabled","onClick"])):D("",!0),d.row.status!==1?(f(),h(i,{key:1,type:"primary",link:"",icon:"View",disabled:!b(_)["btn.UserNormal.view"],onClick:k=>y(d.row.id)},{default:r(()=>[m(" 详情 ")]),_:2},1032,["disabled","onClick"])):D("",!0)]),_:1},8,["requestApi"]),l(z,{ref_key:"DialogRef",ref:o},null,512)])}}});export{W as default};
