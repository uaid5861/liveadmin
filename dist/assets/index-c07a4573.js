import{u as $,h as E}from"./useAuth-2ec42edf.js";import{u as M}from"./useAuthButtons-9e7fcd42.js";import{g as z,d as Y,a as q}from"./anchor-13bf35db.js";import{d as S,V as C,r as h,a as r,o as b,f as B,g as l,e as a,b as n,k as y,t as k,Q as d,c as A,p as H,F as D,A as I,l as j,j as O,a8 as Q,i as U}from"./index-e1b9afb8.js";import{S as X}from"./constant-caca95d8.js";import{u as G}from"./useHandleData-9b50ca4a.js";const J=S({name:"RoleDialog"}),K=S({...J,setup(N,{expose:x}){let s=C({name:"",remark:"",time:"",birthday:"",idCardUrl:[]});const p=C({status:"1",remark:""}),g=C({status:[{required:!0,message:"请选择认证意见"}]}),c=h(!1),m=h(!1),f=h({id:""}),V=async o=>{s=await o.anchor||{},f.value=o,m.value=!0},v=h(),e=()=>{v.value.validate(async o=>{if(o)try{c.value=!0;const t={id:f.value.id,...p};await f.value.api(t),I.success({message:"审批成功！"}),f.value.getTableList(),m.value=!1,c.value=!1}catch(t){c.value=!1,console.log(t)}})};return x({acceptParams:V}),(o,t)=>{const u=r("el-form-item"),_=r("el-image"),w=r("el-radio"),F=r("el-radio-group"),R=r("el-input"),L=r("el-form"),T=r("el-button"),P=r("el-dialog");return b(),B(P,{modelValue:m.value,"onUpdate:modelValue":t[3]||(t[3]=i=>m.value=i),"destroy-on-close":!0,title:"认证",width:"50%"},{footer:l(()=>[a(T,{onClick:t[2]||(t[2]=i=>m.value=!1)},{default:l(()=>[n("取消")]),_:1}),a(T,{type:"primary",onClick:e,loading:c.value},{default:l(()=>[n(" 确定 ")]),_:1},8,["loading"])]),default:l(()=>[a(L,{ref_key:"ruleFormRef",ref:v,"label-width":"120px","label-suffix":" :",rules:g,model:{...p}},{default:l(()=>[a(u,{label:"真实姓名"},{default:l(()=>[y("span",null,k(d(s).name),1)]),_:1}),a(u,{label:"出生年月"},{default:l(()=>[y("span",null,k(d(s).birthday),1)]),_:1}),a(u,{label:"身份证照片"},{default:l(()=>[(b(!0),A(D,null,H(d(s).idCardUrl,i=>(b(),A("div",{key:i,class:"block"},[a(_,{style:{width:"150px","margin-right":"15px"},src:i,"preview-src-list":d(s).idCardUrl},null,8,["src","preview-src-list"])]))),128))]),_:1}),a(u,{label:"申请时间"},{default:l(()=>[y("span",null,k(d(s).time),1)]),_:1}),a(u,{label:"备注"},{default:l(()=>[y("span",null,k(d(s).remark),1)]),_:1}),a(u,{label:"是否通过认证",prop:"level"},{default:l(()=>[a(F,{modelValue:p.status,"onUpdate:modelValue":t[0]||(t[0]=i=>p.status=i),class:"ml-4"},{default:l(()=>[a(w,{label:"1",size:"large"},{default:l(()=>[n("通过")]),_:1}),a(w,{label:"0",size:"large"},{default:l(()=>[n("不通过")]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"备注",prop:"remark"},{default:l(()=>[a(R,{width:"70%",modelValue:p.remark,"onUpdate:modelValue":t[1]||(t[1]=i=>p.remark=i),autosize:{minRows:3,maxRows:5},type:"textarea",placeholder:"请输入审核备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])}}}),re=S({__name:"index",setup(N){const x=j(),{BUTTONS:s}=M(),p=[{prop:"id",label:"ID",width:80,fixed:"left"},{prop:"name",label:"用户名",fixed:"left",search:{el:"input",props:{placeholder:"请输入用户名"}}},{prop:"avatar",label:"头像",width:100,render:({row:e})=>a(D,null,[a(r("el-avatar"),{size:50,src:e.avatar},null)])},{prop:"phone",label:"手机号",width:140,search:{el:"input",props:{placeholder:"请输入手机号"}}},{prop:"sex",label:"性别",width:100,render:({row:e})=>e.sex===0?"男":"女",fieldNames:{label:"name",value:"id"},enum:O(()=>X||[]),search:{el:"select",props:{placeholder:"请选择性别"}}},{prop:"account",label:"余额",width:100},{prop:"liveTimes",label:"开播次数",width:100,search:{el:"input",props:{placeholder:"请输入开播次数"}}},{prop:"onlineStatus",label:"在线状态",width:100,render:({row:e})=>e.onlineStatus===0?a(r("el-tag"),{type:"success"},{default:()=>[n("在线")]}):a(r("el-tag"),{type:"info"},{default:()=>[n("离线")]})},{prop:"authStatus",label:"主播认证",width:100,render:({row:e})=>e.authStatus===0?a(r("el-tag"),{type:"warning"},{default:()=>[n("未认证")]}):a(r("el-tag"),null,{default:()=>[n("已认证")]})},{prop:"createTime",label:"认证时间",width:180,search:{el:"date-picker",props:{type:"datetimerange",valueFormat:"YYYY-MM-DD HH:mm:ss"}}},{prop:"status",label:"状态",width:100,render:({row:e})=>a(r("el-switch"),{modelValue:e.status,"onUpdate:modelValue":o=>e.status=o,"active-text":e.status?"启用":"禁用",onClick:()=>V(e)},null)},{prop:"operation",label:"操作",fixed:"right",width:180}],g=h(),c=h(),m=async e=>{var t;await $(E("btn.UserNormal.update"));let o={id:e,api:Y,anchor:f(e),getTableList:(t=g.value)==null?void 0:t.getTableList};c.value.acceptParams(o)},f=async e=>(await q(e)).data,V=async e=>{await G(Q,{type:"normalUser",id:e.id,status:e.status==1?0:1},`切换【${e.name}】用户状态`)},v=e=>{x.push({path:`/user/anchor/show/${e}`})};return(e,o)=>{const t=r("el-button"),u=r("ProTable");return b(),A("div",null,[a(u,{ref_key:"proTable",ref:g,columns:p,requestApi:d(z)},{operation:l(_=>[_.row.authStatus===0?(b(),B(t,{key:0,type:"primary",link:"",icon:"Unlock",disabled:!d(s)["btn.UserNormal.update"],onClick:w=>m(_.row.id)},{default:l(()=>[n(" 认证 ")]),_:2},1032,["disabled","onClick"])):U("",!0),_.row.status!==1?(b(),B(t,{key:1,type:"primary",link:"",icon:"View",disabled:!d(s)["btn.UserNormal.view"],onClick:w=>v(_.row.id)},{default:l(()=>[n(" 详情 ")]),_:2},1032,["disabled","onClick"])):U("",!0)]),_:1},8,["requestApi"]),a(K,{ref_key:"DialogRef",ref:c},null,512)])}}});export{re as default};
